---
homeassistant:
  customize_glob:
    "sensor.euro95_*":
      unit_of_measurement: "€/L"
      icon: mdi:gas-station
    "sensor.diesel_*":
      unit_of_measurement: "€/L"
      icon: mdi:gas-station
    "sensor.lpg_*":
      unit_of_measurement: "€/L"
      icon: mdi:gas-station

sensor:
  - platform: scrape
    resource: "http://lukoil.nl/go/lukoil_station.cfm?id=465"
    name: Euro95 (Lukoil Schermerhoek)
    select: "#tabbedInfoContent div.tab:nth-of-type(2) .priceBox2 .price"
    value_template: "{{ value|replace('EUR/L', '')|float|round(3) }}"
    scan_interval: 3600  # be nice; once per hour only

  - platform: scrape
    name: Euro95 (Tinq Bermweg)
    resource: "https://www.tinq.nl/tankstations/capelle-ad-ijssel-bermweg"
    # yamllint disable-line rule:line-length
    select: ".field--name-field-station-prices .taxonomy-term-Euro95 .field--name-field-prices-price-pump"
    value_template: "{{value|replace('€','')|
      replace('EUR/L','')|float|round(3)}}"
    scan_interval: 3600  # be nice; once per hour only

automation:
  - alias: Euro95 gewijzigd
    description: 'Notification for updated Euro95 fuel prices'

    id: cea83bd6-bc1a-4973-b080-8ed2bb9a3026
    mode: queued

    trigger:
      - platform: state
        entity_id:
          - sensor.adviesprijs_euro95
          - sensor.euro95_sakko_metaalhof
          - sensor.euro95_dijktank_kanaalweg
          - sensor.euro95_tinq_bermweg
          - sensor.euro95_lukoil_schermerhoek

    action:
      - service: notify.robert
        data:
          message: >
            {{ state_attr(trigger.entity_id,'friendly_name') }}
            is gewijzigd naar
            {{ trigger.to_state.state }}
            {{ state_attr(trigger.entity_id,'unit_of_measurement')}}.
