- id: '1642157915331'
  alias: 'System: Home Assistant Alert'
  description: ''
  use_blueprint:
    path: CentralCommand/get-notified-any-time-there-is-a-new-home-assistant-alert.yaml
    input:
      notifier: robert
      urls_supported: true
- id: '1649842819459'
  alias: 'Office: Pause Music'
  description: ''
  trigger:
  - platform: state
    entity_id: sensor.msteams_activity_robert
    to: In gesprek
  condition:
  - condition: state
    entity_id: binary_sensor.working_from_home_robert
    state: 'on'
  - condition: state
    entity_id: media_player.studeerkamer
    state: playing
  action:
  - service: media_player.media_pause
    data: {}
    target:
      device_id: 49324710c6344a809dae725922db2cc6
  - service: input_boolean.turn_on
    data: {}
    target:
      entity_id: input_boolean.resume_office_music
  - service: notify.robert
    data:
      message: Muziek in kantoor gepauzeerd voor een Teamsgesprek.
      title: Teams activity
  mode: single
- id: '1649843570979'
  alias: 'Office: Resume Music'
  description: Resume music when Teams call has finished.
  trigger:
  - platform: state
    entity_id: sensor.msteams_activity_robert
    from: In gesprek
  condition:
  - condition: state
    entity_id: input_boolean.resume_office_music
    state: 'on'
  action:
  - service: media_player.media_play
    data: {}
    target:
      entity_id: media_player.studeerkamer
  - service: input_boolean.turn_off
    data: {}
    target:
      entity_id: input_boolean.resume_office_music
  - service: notify.robert
    data:
      message: Muziek in het kantoor voortgezet.
      title: Teams activity
  mode: single
- id: 79b3abe8-e220-4563-a55b-74bd3b850a3b
  alias: 'Lighting: Living lights on at dusk'
  description: Schakel vlak voor zonsondergang de verlichting in de woonkamer in.
  trigger:
  - event: sunset
    offset: -00:30:00
    platform: sun
  action:
  - service: scene.turn_on
    target:
      entity_id: scene.lighting_living_base
    data: {}
  mode: single
- id: b17bc209-ef49-4199-bb5c-fae6c3f428a4
  alias: 'Lighting: Living lights off during vacations'
  description: Schakel de verlichting tijdens vakanties automatisch uit tussen 23:00
    en 23:30.
  trigger:
  - platform: time
    at: '23:00:00'
  condition:
  - condition: state
    entity_id: input_boolean.occupancy_vacation
    state: 'on'
  action:
  - delay: '{{ "0:" ~ ((range(0,29)|random)|int) ~ ":0" }}'
  - service: light.turn_off
    entity_id: light.living
  - service: notify.admin
    data:
      title: Vakantie
      message: Verlichting automatisch uitgeschakeld.
  mode: single
- id: f120e80e-4717-4199-80a7-f56aee0f8690
  alias: 'Lighting: Living lights dimmed late at night'
  description: Dim woonkamerverlichting laat in de avond
  trigger:
  - platform: time
    at: '23:30'
  condition:
  - condition: state
    entity_id: light.living
    state: 'on'
  - condition: not
    conditions:
    - condition: state
      entity_id: input_boolean.occupancy_vacation
      state: 'on'
  action:
  - service: scene.turn_on
    data: {}
    target:
      entity_id: scene.lighting_living_dimmed
  mode: single
- id: b24e7ee3-fbd7-4e91-9116-095d7b24c843
  alias: 'Lighting: Living lights wall switch on/off'
  description: In/uitschakelen verlichting in de woonkamer bij gebruik linker wandschakelaar.
  trigger:
  - platform: state
    entity_id: binary_sensor.wandschakelaar_links
  action:
  - choose:
    - conditions:
      - condition: template
        value_template: '{{ trigger.to_state.state == ''on'' }}'
      sequence:
      - service: scene.turn_on
        data: {}
        target:
          entity_id: scene.lighting_living_base
    default:
    - service: light.turn_off
      data: {}
      target:
        entity_id: light.living
  mode: single
- id: 8d8468fb-3baf-41be-88ee-9a3a71910909
  alias: 'Lighting: Garden On'
  description: Turn on the garden lights at sunset
  trigger:
  - platform: sun
    event: sunset
  action:
  - service: light.turn_on
    data:
      brightness_pct: 70
      transition: 20
    target:
      device_id: c33e67f585956e6f98937073162f6bfd
  mode: single
- id: 61ddaf89-65e3-4853-b80d-e0abea5ec53c
  alias: 'Lighting: Garden Off'
  description: Turn off the garden lights at sunrise
  trigger:
  - platform: sun
    event: sunrise
    offset: -01:00:00
  action:
  - service: light.turn_off
    data:
      transition: 20
    target:
      device_id: c33e67f585956e6f98937073162f6bfd
  mode: single
- id: c1de5e22-30c1-41c6-873a-88e081e7048a
  alias: Signaallamp - bijwerken via scene
  description: Werk de signaallamp bij met behulp van de geselecteerde scene.
  trigger:
  - entity_id: input_select.signaallamp_scene
    platform: state
  action:
  - data:
      entity_id: '{{(''scene.signaal_'' ~ trigger.to_state.state)|lower| replace(''
        '',''_'')}}'
    service: scene.turn_on
- id: ff08a450-aa5f-4bc4-bf21-bdea71c552ce
  alias: Signaallamp - uitschakelen synchroniseren met scene
  description: Synchroniseer scene input (en activeer daarmee de scene) als de signaallamp
    handmatig wordt uitgeschakeld.
  trigger:
  - entity_id: light.signaal
    platform: state
    to: 'off'
  action:
  - data:
      entity_id: input_select.signaallamp_scene
      option: Uit
    service: input_select.select_option
- id: 26e358e0-da5c-4ef1-8349-e9f0bde623bd
  alias: Signaallamp - regenalarm melden op werkdagen
  description: Trigger rain alarm when rain expected on workdays between 6 and 9 am,
    but only when someone is home
  trigger:
  - above: 0
    entity_id: sensor.buienradar_precipitation_forecast_average
    platform: numeric_state
  condition:
  - condition: state
    entity_id: binary_sensor.signaallamp_ingeschakeld
    state: 'on'
  - condition: time
    after: 06:00:00
    before: 09:00:00
  - condition: state
    entity_id: binary_sensor.workday
    state: 'on'
  - condition: state
    entity_id: input_boolean.verlof
    state: 'off'
  - condition: state
    entity_id: sensor.occupancy
    state: home
  - condition: state
    entity_id: group.family
    state: home
  action:
  - service: input_select.select_option
    data:
      entity_id: input_select.signaallamp_scene
      option: Regenalarm
  mode: single
- id: ca89521c-7219-4e8e-acda-9c9537ff98a1
  alias: Signaallamp - regenalarm annuleren
  description: Annuleer regenalarm om 9:00 of als er geen regen meer wordt verwacht.
  trigger:
  - platform: template
    value_template: '{{ states(''sensor.buienradar_precipitation_forecast_average'')
      |float==0}}'
  - at: 09:00:00
    platform: time
  condition:
  - condition: state
    entity_id: input_select.signaallamp_scene
    state: Regenalarm
  action:
  - service: input_select.select_option
    data:
      entity_id: input_select.signaallamp_scene
      option: Uit
- id: '1658943860235'
  alias: TV Woonkamer - Inschakelen
  description: Door deze automatisering te activeren, verschijnt de power on knop
    in de mediaspeler in het dashboard.
  use_blueprint:
    path: cvroque/webostv_turn_on.yaml
    input:
      webostv: media_player.living_tv
      webostv_mac: 04:4E:AF:13:F9:7C
- id: '1660887358846'
  alias: 'Lighting: Kledingkast Bjorn altijd aan'
  description: De verlichting in de kledingkast moet altijd aan staan, zodat de sensor
    het licht kan inschakelen.
  trigger:
  - platform: device
    type: turned_off
    device_id: 6d83fdc507bebb0799f1ad633c94cb7a
    entity_id: light.kledingkast_bjorn
    domain: light
  condition: []
  action:
  - type: turn_on
    device_id: 6d83fdc507bebb0799f1ad633c94cb7a
    entity_id: light.kledingkast_bjorn
    domain: light
    brightness_pct: 50
  mode: single
- id: 068719c4-88f2-44b5-a809-e2513ae65604
  alias: 'Weer: Buienalarm melden'
  description: Notify for rain alarms
  trigger:
  - platform: state
    entity_id: sensor.buienalarm_precipitation_forecast_level
  condition:
  - condition: not
    conditions:
    - condition: or
      conditions:
      - condition: state
        entity_id: sensor.buienalarm_precipitation_forecast_level
        state: '0'
      - condition: state
        entity_id: sensor.buienalarm_precipitation_forecast_level
        state: unavailable
  action:
  - service: notify.robert
    data:
      title: ☔️ Buienalarm
      message: '{{ state_attr(''sensor.buienalarm_precipitation_forecast_level'',
        ''label'') }} ({{ states(''sensor.buienalarm_precipitation_forecast_average'')
        }} {{ state_attr(''sensor.buienalarm_precipitation_forecast_average'', ''unit_of_measurement'')
        }}) verwacht.

        '
      data:
        url: 'https://www.buienalarm.nl/{{ state_attr(''zone.home'', ''latitude'')
          }},{{ state_attr(''zone.home'',''longitude'') }}

          '
  - service: notify.twitter
    data:
      message: "☔️ {{ state_attr(trigger.entity_id,'label') }} vlakbij verwacht. {{
        [ \"Vergeet je regenjas \U0001F9E5 niet mee te nemen!\", \"Neem een paraplu
        \U0001F302 mee!\", \"Je bent ⚠️ gewaarschuwd!\", \"Hou @buienalarm \U0001F327️
        in de gaten!\" ] | random  }} https://www.buienalarm.nl/ #buienalarm"
  mode: single
- id: '1661359954658'
  alias: Presence - Robert bijna thuis
  description: ''
  trigger:
  - platform: numeric_state
    entity_id: proximity.robert_from_home
    below: '500'
  condition:
  - condition: and
    conditions:
    - condition: state
      entity_id: person.robert
      state: not_home
    - condition: state
      entity_id: proximity.robert_from_home
      attribute: dir_of_travel
      state: towards
    - condition: state
      entity_id: input_boolean.do_not_disturb
      state: 'off'
  action:
  - service: notify.robert
    data:
      message: Robert is minder dan {{ states('proximity.robert_from_home') }} meter
        van huis. Hij is er bijna.
  mode: single
- id: '1660920784418'
  alias: 'Media: Update Sonos Source Selector'
  description: Update input selector with when Sonos favorites update.
  trigger:
  - platform: state
    entity_id:
    - input_select.sonos_favorites
  - platform: homeassistant
    event: start
  condition: []
  action:
  - variables:
      favs: '{{ state_attr(''sensor.sonos_favorites'', ''items'').values() | list
        }}'
  - service: input_select.set_options
    data:
      options: '{{ favs }}'
    target:
      entity_id: input_select.sonos_favorites
  mode: single
- id: '1660923058113'
  alias: 'Media: Play selected Sonos favorite on kitchen speaker'
  description: Switch to selected favorite (playlist or radio) when Office speaker
    is already playing.
  trigger:
  - platform: state
    entity_id:
    - input_select.sonos_favorites
  condition:
  - condition: device
    device_id: 7bdba22c447d5ca9504e896de5e891d4
    domain: media_player
    entity_id: media_player.kantoorspeaker
    type: is_playing
  action:
  - service: media_player.select_source
    target:
      entity_id: media_player.kantoorspeaker
    data:
      source: '{{ states(''input_select.sonos_favorites'') }}'
  mode: single
- id: '1661499047537'
  alias: ZHA - Lichtstraat remote
  description: ''
  use_blueprint:
    path: metbril/zha_ikea_tradfri_2button_onoff_brightness.yaml
    input:
      remote: 28bb8ad428cbbf06defd66c0d19deaac
      light: light.lichtstraat
      speed: 100
- id: '1661505565179'
  alias: 'Lighting: Sun control outdoor lights'
  description: Switch the outdoor lights on/off based on sun elevation
  trigger:
  - platform: numeric_state
    entity_id: sun.sun
    attribute: elevation
    above: '1'
  - platform: numeric_state
    entity_id: sun.sun
    attribute: elevation
    below: '1'
  condition: []
  action:
  - choose:
    - conditions:
      - condition: numeric_state
        entity_id: sun.sun
        attribute: elevation
        above: '1'
      sequence:
      - service: light.turn_off
        data:
          transition: 5
        target:
          entity_id: light.achtergevel
    - conditions:
      - condition: numeric_state
        entity_id: sun.sun
        attribute: elevation
        below: '1'
      sequence:
      - service: light.turn_on
        data:
          transition: 5
          brightness_pct: 70
        target:
          entity_id: light.achtergevel
    default: []
  - service: notify.robert
    data:
      message: Sun outdoor lights triggered, please check the light.
  mode: single
- id: '1661506070664'
  alias: Notify printer on
  description: ''
  trigger:
  - platform: state
    entity_id:
    - switch.samsung_ml_2850nd
    to: 'on'
    for:
      hours: 0
      minutes: 30
      seconds: 0
  condition: []
  action:
  - service: notify.mobile_app_iphone_robert
    data:
      message: Printer staat nog aan
      data:
        actions:
        - action: PRINTER_OFF
          title: Printer uit
  - wait_for_trigger:
    - platform: event
      event_type: mobile_app_notification_action
      event_data:
        action: PRINTER_OFF
  - choose:
    - conditions:
      - condition: template
        value_template: '{{ wait.trigger.event.data.action == ''PRINTER_OFF'' }}'
      sequence:
      - service: switch.turn_off
        data: {}
        target:
          entity_id: switch.samsung_ml_2850nd
      - service: notify.robert
        data:
          message: Printer uit
    default: []
  mode: single
- id: '1661538513078'
  alias: Lightsaver Sfeerverlichting
  description: ''
  use_blueprint:
    path: niro1987/lightsaver.yaml
    input:
      light: light.sfeerverlichting
      sunset_delay: -50
- id: '1661884728867'
  alias: Occupancy - Sync states
  description: 'Synchroniseer alle knoppen. Als er een wordt ingeschakeld, worden
    alle andere uitgeschakeld. Als alles is uitgeschakeld, wordt Thuis ingeschakeld.

    '
  trigger:
  - platform: state
    entity_id:
    - input_boolean.occupancy_home
    - input_boolean.occupancy_eco
    - input_boolean.occupancy_away
    - input_boolean.occupancy_asleep
    - input_boolean.occupancy_party
    - input_boolean.occupancy_guests
    - input_boolean.occupancy_vacation
  action:
  - variables:
      all_off: '{{ states.input_boolean | select(''search'', ''occupancy_'')  | selectattr(''state'',
        ''eq'', ''on'') | map(attribute=''entity_id'') | list | count == 0 }}'
  - choose:
    - conditions:
      - condition: template
        value_template: '{{ trigger.to_state.state == ''on'' }}'
      sequence:
      - service: input_boolean.turn_off
        data:
          entity_id: "{{ states.input_boolean | select('search', 'occupancy_') | \n
            \ map(attribute='entity_id') |\n  reject('equalto', trigger.entity_id)
            | list | join(', ') }}\n"
    - conditions:
      - condition: template
        value_template: "{{ states.input_boolean | select('search', 'occupancy_')
          \ \n  | selectattr('state', 'eq', 'on') \n  | map(attribute='entity_id')
          | list | count == 0 }}"
      sequence:
      - service: input_boolean.turn_on
        data:
          entity_id: input_boolean.occupancy_home
    default: []
  initial_state: true
  mode: queued
- id: '1661885320722'
  alias: Occupancy - Absence reminder
  description: Notify when vacation or guest occupancy, and daily when still in vacation
    or guest mode
  trigger:
  - platform: state
    entity_id: sensor.occupancy
    to: vacation
  - platform: state
    entity_id: sensor.occupancy
    to: guests
  - platform: time
    at: 09:00:00
  condition:
  - condition: or
    conditions:
    - condition: state
      entity_id: sensor.occupancy
      state: vacation
    - condition: state
      entity_id: sensor.occupancy
      state: guests
  action:
  - service: notify.admin
    data:
      title: Bezetting
      message: "\U0001F9F7 De woning is ingesteld op bezetting door {{ label | lower
        }}."
  variables:
    mode: '{{ states(''sensor.occupancy'') }}'
    name: '{{ ''input_boolean.occupancy_'' + mode }}'
    label: '{{ state_attr(name, ''friendly_name'') }}'
- id: 934b4450-7816-4064-b906-3a3894d99345
  alias: Energy - Save consumption to file
  description: "Save energy consumption to file every hour, at the full hour.\nEntities
    used: \n- sensor.energy_consumption_tarif_1 \n- sensor.energy_consumption_tarif_2\n
    - sensor.gas_consumption"
  trigger:
  - platform: time_pattern
    hours: '*'
    minutes: '0'
    seconds: '0'
  action:
  - service: notify.save_energy_consumption
    data:
      message: '{{ now() }}, {{ states(''sensor.energy_consumption_tarif_1'') }},
        {{ states(''sensor.energy_consumption_tarif_2'') }}, {{ states(''sensor.gas_consumption'')}}

        '
  - service: logbook.log
    data:
      name: Energieverbruik (tarief 1)
      message: opgeslagen
      entity_id: sensor.energy_consumption_tarif_1
      domain: sensor
  - service: logbook.log
    data:
      name: Energieverbruik (tarief 2)
      message: opgeslagen
      entity_id: sensor.energy_consumption_tarif_2
      domain: sensor
  - service: logbook.log
    data:
      name: Gasverbruik
      message: opgeslagen
      entity_id: sensor.gas_consumption
      domain: sensor
- id: '1662102264901'
  alias: 'Appliances: Wasmachine is klaar'
  description: Verstuur meldingen als de wasmachine klaar is.
  use_blueprint:
    path: metbril/appliance_has_finished.yaml
    input:
      power_sensor: sensor.washing_machine_power
      starting_hysteresis:
        hours: 0
        minutes: 1
        seconds: 0
      finishing_hysteresis:
        hours: 0
        minutes: 1
        seconds: 0
      starting_threshold: 4
      finishing_threshold: 4
      actions:
      - service: notify.robert
        data:
          message: "\U0001F45A\U0001F455\U0001F4A6 Wasmachine is klaar."
      - service: script.sonos_say
        data:
          entity_id: media_player.living_speaker
          message: De wasmachine is klaar.
      - service: notify.living_tv
        data:
          message: Wasmachine is klaar.
          data:
            icon: /config/www/img/washing-machine.png
      pre_actions:
      - service: notify.robert
        data:
          message: "\U0001F45A\U0001F455\U0001F4A6 Wasmachine is gestart."
- id: '1662104026902'
  alias: 'Appliances: Wasdroger is klaar'
  description: Verstuur meldingen als de wasdroger klaar is.
  use_blueprint:
    path: metbril/appliance_has_finished.yaml
    input:
      power_sensor: sensor.tumble_dryer_power
      starting_hysteresis:
        hours: 0
        minutes: 1
        seconds: 0
      finishing_hysteresis:
        hours: 0
        minutes: 1
        seconds: 0
      starting_threshold: 4
      finishing_threshold: 4
      actions:
      - service: notify.robert
        data:
          message: "\U0001F9FA\U0001F4A8 Wasdroger is klaar."
      - service: script.sonos_say
        data:
          entity_id: media_player.living_speaker
          message: De wasdroger is klaar.
      - service: notify.living_tv
        data:
          message: Wasdroger is klaar.
          data:
            icon: /config/www/img/dryer.png
      pre_actions:
      - service: notify.robert
        data:
          message: "\U0001F9FA\U0001F4A8 Wasdroger is gestart."
- id: '1662116397887'
  alias: 'Security: Warn when door is open after everyone has left'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - group.family
    from: home
    for:
      hours: 0
      minutes: 5
      seconds: 0
  condition:
  - condition: state
    entity_id: binary_sensor.schuifpui_sensor_state_door_window
    state: 'on'
  action:
  - service: notify.parents
    data:
      message: '⚠️ Er is niemand meer thuis, maar er zijn nog vensters en deuren geopend. '
  mode: single
- id: '1662123937783'
  alias: 'Presence: Robert verlaat werk'
  description: ''
  use_blueprint:
    path: homeassistant/notify_leaving_zone.yaml
    input:
      person_entity: person.robert
      zone_entity: zone.maasstad
      notify_device: 0837dc1d02ba452e9d46a4cbdc5e3638
- id: '1662124763401'
  alias: 'Presence: Robert verlaat werk na 16:00 uur (custom)'
  description: ''
  trigger:
  - platform: zone
    entity_id: person.robert
    zone: zone.maasstad
    event: leave
  condition:
  - condition: time
    after: '16:00:00'
    weekday:
    - mon
    - tue
    - wed
    - thu
  action:
  - service: notify.monique
    data:
      message: "Robert is onderweg naar huis. \U0001F6B4‍♂️\U0001F4A8\U0001F618"
      data:
        icon_url: /local/img/people/robert.png
  - service: script.sonos_say
    data:
      entity_id: media_player.living_speaker
      message: Robert is onderweg naar huis.
      volume_percent: 15
  mode: single
