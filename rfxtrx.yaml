################################################
## Packages RFXTRX
################################################

homeassistant:
  customize:

    ################################################
    ## Node Anchors
    ################################################

    package.node_anchors:
      customize: &customize
        package: 'rfxtrx'

      expose: &expose
        <<: *customize
        haaska_hidden: false
        homebridge_hidden: false

    ################################################
    ## Sensor
    ################################################

    ################################################
    ## Group
    ################################################

    group.kaku_remote_living:
      <<: *customize
      friendly_name: KAKU Afstandsbediening Woonkamer


################################################
## RFXTRX
## https://home-assistant.io/components/rfxtrx/
################################################

rfxtrx:
  device: /dev/ttyRFXCOM
  debug: yes

############################################################
## Cover
############################################################

cover:
  - platform: rfxtrx
    automatic_add: false

############################################################
## Light
############################################################

# Prefix:
# 0b is the length of the datapacket
# 11 means Lighting2
# 00 means subtype AC

# 0b 11 00 310 0bb1362 01 010f60   0bb13621

light:
  - platform: rfxtrx
    automatic_add: true
    devices:
      0b1100200099acb60b010f70: # 099acb611 kaku wall left
        name: KAKU Wall Switch Left
      0b11002c0099acb60c000070: # 099acb612 kaku wall right
        name: KAKU Wall Switch Right
      0b1100100f05e81202010f70: # KAKU APA3-1500R (2)
        name: Living Desk

############################################################
## Binary Sensor
############################################################

binary_sensor:
  platform: rfxtrx
  automatic_add: false

############################################################
## Sensor
############################################################

sensor:
  - platform: rfxtrx
    automatic_add: false
    devices:
      0a5207023f0e0074380159:
        name: PWS TH
        data_type:
          - Humidity
          - Temperature
      0b55030c800c0000000a9569:
        name: PWS Rain
        data_type:
          - Rain rate
      105604029716013b000b000c0027002059:
        name: PWS Wind
        data_type:
          - Wind direction

############################################################
## Switch
############################################################

switch:
  - platform: rfxtrx
    automatic_add: true
    devices:
      0b110010011600020a010f70: # kaku motion
        name: Motion Garage
        fire_event: True
      0b11001000bb136201010f60: # 0bb13621 kaku remote 1
        name: KAKU Remote Living Button 1
      0b11001000bb136202010f60: # 0bb13622 kaku remote 2
        name: KAKU Remote Living Button 2
      0b11001000bb136203010f60: # 0bb13623 kaku remote 3
        name: KAKU Remote Living Button 3

      # not paired yet
      # 0b1100100f05e8120a010f60:
      #  name: Diner Ceiling
      # not paired yet
      # 0b1100100f05e8120b010f60:
      #  name: Sofa Ceiling

      0a140f01000b5501010f60: # lighting5 it 2901.01 On
        name: Power Garage Door

      0b1100100029fc0201010f60:
        name: Flamingo Remote Garage Button A
        fire_event: true
      0b1100100029fc0202010f60:
        name: Flamingo Remote Garage Button B
        fire_event: true
      0b1100100029fc0203010f60:
        name: Flamingo Remote Garage Button C
        fire_event: true
      0b1100100029fc0204010f60:
        name: Flamingo Remote Garage Button D
        fire_event: true

group:
  rfxtrx:
    name: RFXTRX
    view: yes
    entities:
      - group.kaku_remote_living
      - group.flamingo_remote_garage
  kaku_remote_living:
    name: KAKU Remote Living
    entities:
      - switch.kaku_remote_living_button_1
      - switch.kaku_remote_living_button_2
      - switch.kaku_remote_living_button_3
  flamingo_remote_garage:
    name: Flamingo Remote Garage
    entities:
      - switch.flamingo_remote_garage_button_a
      - switch.flamingo_remote_garage_button_b
      - switch.flamingo_remote_garage_button_c
      - switch.flamingo_remote_garage_button_d

automation:
  - alias: remote button a
    trigger:
      - platform: state
        entity_id: switch.flamingo_remote_garage_button_a
    action:
      - service: notify.telegram
        data_template:
          title: '**RFXTRX**'
          message: 'Afstandsbediening knop A {{ states.switch.flamingo_remote_garage_button_a.state }}'
