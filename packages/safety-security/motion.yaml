############################################################################
## Packages / Safety-Security / Motion
############################################################################

homeassistant:
  customize:

    ########################################################################
    ## Node Anchors
    ########################################################################

    package.node_anchors:
      customize: &customize
        package: 'motion'

      expose: &expose
        <<: *customize
        haaska_hidden: false
        homebridge_hidden: false

    ########################################################################
    ## Binary Sensor
    ########################################################################

    binary_sensor.benext_molite_8_motion:
      <<: *customize
      device_class: motion
      friendly_name: 'Beweging woonkamer'

    ################################################
    ## Sensor
    ################################################

    sensor.benext_molite_8_battery_level:
      <<: *customize
      friendly_name: 'Batterij beweging woonkamer'
      device_class: battery
      unit_of_measurement: "%"

    sensor.benext_molite_8_temperature:
      <<: *customize
      friendly_name: 'Temperatuur woonkamer'

    sensor.benext_molite_8_luminance:
      <<: *customize
      friendly_name: 'Lichtsterkte woonkamer'
      icon: mdi:brightness-6

    ########################################################################
    ## Group
    ########################################################################

    group.motion:
      <<: *customize
      friendly_name: 'Bewegingsensoren'
      icon: mdi:run

################################################
## Sensor
################################################

sensor:
  - platform: template
    sensors:
      benext_molite_8_battery_level:
        value_template: "{{ states.zwave.benext_molite_8.attributes.battery_level }}"
        # value_template:  "states('zwave.benext_molite_8.attributes.battery_level')|int('unknown')"
        # icon_template: >-
        #   {% set battery_level = states('sensor.benext_molite_8_battery_level')|int('unknown') %}
        #   {% set battery_round = (battery_level|int / 10)|int * 10 %}
        #   {% if battery_level == unknown -%}
        #     mdi:battery-unknown
        #   {% elif battery_round >= 100 -%}
        #     mdi:battery
        #   {% elif battery_round > 0 -%}
        #     mdi:battery-{{ battery_round }}
        #   {% else -%}
        #     mdi:battery-alert
        #   {% endif %}

############################################################################
## Group
############################################################################

group:
  motion:
    name: Motion
    entities:
      - binary_sensor.motion_garage
      - binary_sensor.benext_molite_8_motion

  benext_molite_8:
    name: BeNext Molite (Node 8)
    entities:
      - binary_sensor.benext_molite_8_motion
      - sensor.benext_molite_8_temperature
      - sensor.benext_molite_8_luminance
      - sensor.benext_molite_8_battery_level
      - sensor.benext_molite_8_alarm_level
      - sensor.benext_molite_8_alarm_type
      - zwave.benext_molite_8
