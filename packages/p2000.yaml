# ----------------------------------------------------------------------
# P2000
# https://github.com/cyberjunky/home-assistant-p2000
# ----------------------------------------------------------------------

homeassistant:
  customize:

    # ----------------------------------------
    # Sensor
    # ----------------------------------------
    sensor.p2000_brandweer:
      icon: mdi:fire-truck

# ----------------------------------------
# Sensor
# ----------------------------------------
sensor:
  - platform: p2000
    name: P2000 Brandweer
    regios: 17                  # rotterdam rijnmond
    disciplines: 1              # brandweer
    radius: 5000                # meter, default 5000
    scan_interval: 60           # seconden, default 30

# ----------------------------------------
# Automation
# ----------------------------------------
automation:
  - alias: 'Melden P2000 Brandweer'
    trigger:
      platform: state
      entity_id: sensor.p2000_brandweer
    condition:
      condition: template
      value_template: "{{ states('sensor.p2000_brandweer') != 'unknown' }}"
    action:
      - service_template: notify.admin
        data_template:
          title: "ðŸš’ P2000 Brandweer"
          message: "{{ states('sensor.p2000_brandweer') }}"
          data:
            url: "http://www.openstreetmap.org/?mlat={{ state_attr('sensor.p2000_brandweer', 'latitude') }}&mlon={{ state_attr('sensor.p2000_brandweer', 'longitude') }}&zoom=16"
      - service: notify.twitter
        data_template: # blank line in message for newline
          message: >-
            ðŸš’ De #brandweer is in de buurt. #P2000
            
            {{ states('sensor.p2000_brandweer') }}
            https://www.openstreetmap.org/?mlat={{ state_attr('sensor.p2000_brandweer', 'latitude') }}&mlon={{ state_attr('sensor.p2000_brandweer', 'longitude') }}&zoom=16
