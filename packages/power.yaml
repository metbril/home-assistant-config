## Raspberry Pi Charger Sensor
## https://community.home-assistant.io/t/raspberry-pi-charger-sensor/58155

sensor:
  - platform: command_line
    name: 'System: number of undervoltage messages'
    command: "dmesg | grep Under-voltage | wc -l"
    unit_of_measurement: 'times'
    scan_interval: 120

  # - platform: command_line
  #   name: 'System: undervoltage status'
  #   command: vcgencmd get_throttled
  #   scan_interval: 120

  # - platform: template
  #   sensors:
  #       check_charger:
  #         friendly_name: "System: Charger"
  #         value_template: >
  #           {% if is_state("sensor.system_undervoltage_status", "throttled=0x0") -%}
  #             No throttling detected
  #           {% elif regex_match(states("sensor.system_undervoltage_status"), "throttled=0x4", ignorecase=FALSE) or
  #                   regex_match(states("sensor.system_undervoltage_status"), "throttled=0x5", ignorecase=FALSE) -%}
  #             Throttling detected {{ states("sensor.system_number_of_undervoltage_messages") }} {{ state_attr("sensor.system_number_of_undervoltage_messages", "unit_of_measurement") }} 
  #           {% else -%}
  #             There is a problem with your power supply or system, state {{ states("sensor.system_undervoltage_status") }} reported
  #           {%- endif %}
