############################################################################
## Presence
############################################################################

homeassistant:
  customize:

    ########################################################################
    ## Device Tracker
    ########################################################################
    device_tracker.pontius:
      icon: mdi:apple-ios

    ########################################################################
    ## Person
    ########################################################################
    person.bishop:
      name: !secret person_bishop_name
      icon: mdi:chess-bishop
    person.king:
      name: !secret person_king_name
      icon: mdi:chess-king
    person.queen:
      name: !secret person_queen_name
      icon: mdi:chess-queen

############################################################################
## Device Tracker
############################################################################
device_tracker:
  # This requires the asuswrt integration in configuration.yaml
  - platform: asuswrt
    consider_home: 180
    interval_seconds: 60
    new_device_defaults:
      track_new_devices: false
      hide_if_away: false

############################################################################
## Person
############################################################################
person:

############################################################################
## Zone
############################################################################
zone:
  - name: Work King
    latitude: 51.8794643
    longitude: 4.5344588
    radius: 250
    icon: mdi:hospital

############################################################################
## Automation
############################################################################
automation:

  - alias: "Familie thuis"
    trigger:
      - platform: state
        entity_id: group.family
    action:
      - service: notify.admin
        data_template:
          message: >-
            {% set state = trigger.to_state.state %}
            {% if state == 'home' -%}
              Ik heb gemerkt dat er weer iemand thuis is.
            {%- elif state == 'not_home' -%}
              Ik zie dat er niemand meer thuis is.
            {%- else -%}
              Ik weet even niet of er iemand thuis is.            
            {%- endif %}

  - alias: "Notify New Device Detected"
    trigger:
      - platform: event
        event_type: device_tracker_new_device
    action:
      - service: persistent_notification.create
        data:
          message: "Nieuw apparaat herkend. Controleer bestand 'known_devices.yaml' voor details."
          title: "Nieuw apparaat"
      # - service: notify.admin
      #   data_template:
      #     message: "Nieuw apparaat herkend. Controleer bestand 'known_devices.yaml' voor details."
      #     title: "Nieuw apparaat"
