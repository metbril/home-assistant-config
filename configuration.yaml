homeassistant:
  # Name of the location where Home Assistant is running
  name: Start
  # Location required to calculate the time the sun rises and sets
  latitude: !secret home_lat
  longitude: !secret home_lon
  # Impacts weather/sunrise data (altitude above sea level in meters)
  elevation: !secret home_ele
  # metric for Metric, imperial for Imperial
  unit_system: metric
  # Pick yours from here: http://en.wikipedia.org/wiki/List_of_tz_database_time_zones
  time_zone: Europe/Amsterdam

# Show links to resources in log and frontend
#introduction:

# Enables the frontend
frontend:

# Enables configuration UI
config:

http:
  # Uncomment this to add a password (recommended!)
  api_password: !secret http_password
  # Uncomment this if you are using SSL or running in Docker etc
  # base_url: example.duckdns.org:8123

# Checks for available updates
updater:

# Discover some devices automatically
discovery:

# Allows you to issue voice commands from the frontend in enabled browsers
conversation:

# Enables support for tracking state changes over time.
history:

# View all events in a logbook
logbook:

# Track the sun
sun:

light:
  platform: hue
  host: !secret ip_hue

# Text to speech
tts:
  - platform: google
    language: 'nl'

sensor:
  - platform: time_date
    display_options:
      - 'date'
      - 'time'
  - platform: worldclock
    time_zone: Europe/Amsterdam
  - platform: moon
  - platform: dsmr
    port: /dev/ttyP1
    dsmr_version: 4
  - platform: cpuspeed
  - platform: systemmonitor
    resources:
      - type: memory_use_percent
      - type: processor_use
      - type: disk_use_percent
        arg: /
      - type: last_boot
      - type: since_last_boot
  - platform: speedtest
    monitored_conditions:
      - ping
      - download
      - upload

binary_sensor:
  - platform: template
    sensors:
      cpu_high:
        value_template: '{{ states.sensor.cpu_use.state | float > 50 }}'
        friendly_name: 'CPU is hoog'

notify:
  - name: pushover
    platform: pushover
    api_key: !secret pushover_apikey
    user_key: !secret pushover_userkey

group:

  ### GROUPS ###

  now:
    name: Nu
    entities:
      - sensor.date
      - sensor.time
      - sun.sun
      - sensor.moon
  meter_readings:
    # dsmr slimme meter
    name: Meterstanden
    entities:
      - sensor.power_consumption
      - sensor.power_consumption_low
      - sensor.power_consumption_normal
      - sensor.gas_consumption

  system:
    # Systeeminformatie
    name: Systeem
    entities:
      - sensor.cpu_use
      - sensor.ram_use
      - sensor.disk_use_
      - binary_sensor.cpu_high
      - binary_sensor.cpu_hot
  speedtest:
    name: Speedtest
    entities:
      - sensor.speedtest_download
      - sensor.speedtest_upload
      - sensor.speedtest_ping
  alerts:
    name: Waarschuwingen
    entities:
      - alert.cpu_high
      - alert.cpu_hot
  automation:
    name: Automatisering
    entities:
      - automation.download_laag


  ### VIEWS ###

  view_system:
    name: Systeem
    view: yes
    entities:
      - group.system
      - group.speedtest
  view_automation:
    name: Automatisering
    view: yes
    entities:
      - group.automation
      - group.alert


# ALERT component

alert:
  cpu_high:
    name: CPU is hoog
    entity_id: binary_sensor.cpu_high
    state: 'on'
    repeat: 15
    can_acknowledge: True
    skip_first: False
    notifiers:
      - Pushover

# AUTOMATION component

automation:
  - alias: Download laag
    trigger:
      platform: numeric_state
      entity_id: sensor.speedtest_download
      below: 30
    action:
      service: notify.Pushover
      data:
        message: "Waarschuwing: speedtest download onder 30Mbit/s"
