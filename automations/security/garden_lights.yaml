alias: 'Security - Switch garden lights based on sun elevation'
description: >
  Switch the outdoor lights on/off based on sun elevation.
  Elevation is an attribute of the sun integration.
  Elevetion is more accurate for darkness that a fixed time.
  Elevation varies over time.
  Note: I should create a blueprint for this some day.
id: '1661505565179'
mode: single

trigger:
  - platform: numeric_state
    entity_id: sun.sun
    attribute: elevation
    above: '1'  # rises degrees above the horizon

  - platform: numeric_state
    entity_id: sun.sun
    attribute: elevation
    below: '1' # sinks degrees above horizon

condition: []

action:
  - choose:
      - alias: "When sun rises and passes the degree above horizon"
        conditions:
          - condition: numeric_state
            entity_id: sun.sun
            attribute: elevation
            above: '1'
        sequence:
          - service: light.turn_off
            target:
              entity_id: light.achtergevel
            data:
              transition: 5

      - alias: "When sun sets and passes the degree above horizon"
        conditions:
          - condition: numeric_state
            entity_id: sun.sun
            attribute: elevation
            below: '1'
        sequence:
          - service: light.turn_on
            target:
              entity_id: light.achtergevel
            data:
              transition: 5
              brightness_pct: 70 # not at full brightness

    default: []

  - service: notify.robert
    data:
      message: Sun outdoor lights triggered, please check the light.
