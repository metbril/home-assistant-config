alias: Notify printer on
description: ''
id: '1661506070664'
mode: single

trigger:
  - platform: state
    entity_id:
      - switch.samsung_ml_2850nd
    to: 'on'
    for:
      hours: 0
      minutes: 30
      seconds: 0

condition: []

action:
  - variables:
      - timeout_minutes: "10"

  - service: notify.robert
    data:
      message: Printer staat nog aan
      data:
        actions:
          - action: PRINTER_OFF
            title: Printer uit

  - wait_for_trigger:
      - platform: event
        event_type: mobile_app_notification_action
        event_data:
          action: PRINTER_OFF
    timeout:
      minutes: "{{ timeout_minutes }}"
    continue_on_timeout: false

  - choose:
      - conditions:
          - condition: template
            value_template: "{{ wait.trigger.event.data.action == 'PRINTER_OFF' }}"
        sequence:
          - service: switch.turn_off
            target:
              entity_id: switch.samsung_ml_2850nd

          - service: notify.robert
            data:
              message: Printer uit
    default: []
