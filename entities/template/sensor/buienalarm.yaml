---
- sensor:
    - name: Buienalarm
      unique_id: fce67c62-f0b7-4806-81bc-4d494d59d4fd
      icon: mdi:weather-pouring
      availability: >
        {{ (states('sensor.buienalarm_precipitation_forecast_average') is not none) or
          (states('sensor.buienalarm_precipitation') is not none) }}
      state: >-
          {{ ['Geen neerslag','Lichte neerslag','Matige neerslag',
          'Zware neerslag','Zware buien'][this.attributes.index] }}
      attributes:
        index: >
          {% set forecast = states('sensor.buienalarm_precipitation_forecast_average') | float(0) %}
          {% set current  = states('sensor.buienalarm_precipitation') | float(0) %}
          {% set value    = [forecast, current] | max %}
          {% if value < 0.1 %}
            0
          {% elif value < 1 %}
            1
          {% elif value < 3 %}
            2
          {% elif value < 10 %}
            3
          {% elif value >=10 %}
            4
          {% endif %}
